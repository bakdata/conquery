{
    "type": "STATSTIC_FORM_TEST",
    "label": "MAP-FORM Test",
    "expectedCsv": "tests/form/MAP_FORM/expected.csv",
    "expectedDescription": "tests/form/MAP_FORM/expected_description.json",
    "form": {
        "type": "MAP_FORM",
        "queryGroup": "${dataset}.00000000-0000-0000-0000-000000000001",
        "granularity": "FEDERAL_STATE",
        "dateRange": {
            "min": "2017-03-08",
            "max": "2019-03-04"
        },
        "features" : [
            {
                "type": "OR",
                "children": [
                    {
                        "ids": [
                            "${dataset}.alter"
                        ],
                        "type": "CONCEPT",
                        "label": "Alter",
                        "tables": [
                            {
                                "id": "${dataset}.alter.alter",
                                "filters": []
                            }
                        ]
                    }
                ]
            }
        ],
        "region" : "DEUTSCHLAND",
        "resolution": "COMPLETE_ONLY",
        "relative" : false,
        "title": "test",
        "description": "Beschreibung"
    },
    "concepts": [
        {
            "type" : "VIRTUAL",
            "name" : "alter",
            "label" : "Alter",
            "hidden" : false,
            "connectors" : [
                {
                    "name" : "alter",
                    "label" : "Alter",
                    "validityDates" : [
                        {
                            "name" : "versichertenzeit",
                            "label" : "Versichertenzeit",
                            "column" : "vers_stamm.date"
                        },
                        {
                            "name" : "erster_tag",
                            "label" : "Erster Tag",
                            "column" : "vers_stamm.date_start"
                        },
                        {
                            "name" : "letzter_tag",
                            "label" : "Letzter Tag",
                            "column" : "vers_stamm.date_end"
                        }
                    ],
                    "selects" : [
                        {
                            "type" : "FIRST",
                            "column" : "vers_stamm.geburtsdatum",
                            "name" : "alterseinschränkung_select",
                            "label" : "Alterseinschränkung_select",
                            "description" : "Automatisch erzeugter Zusatzwert.",
                            "default" : true
                        }
                    ],
                    "table" : "vers_stamm",
                    "filter" : {
                        "type" : "DATE_DISTANCE",
                        "name" : "alterseinschränkung",
                        "label" : "Alterseinschränkung",
                        "description" : "Alter zur gegebenen Datumseinschränkung",
                        "column" : "vers_stamm.geburtsdatum",
                        "timeUnit" : "YEARS"
                    }
                }
            ]
        },
        {
            "type" : "VIRTUAL",
            "name" : "geschlecht",
            "label" : "Geschlecht",
            "hidden" : false,
            "connectors" : [
                {
                    "name" : "geschlecht",
                    "label" : "Geschlecht",
                    "validityDates" : [
                        {
                            "name" : "versichertenzeit",
                            "label" : "Versichertenzeit",
                            "column" : "vers_stamm.date"
                        },
                        {
                            "name" : "erster_tag",
                            "label" : "Erster Tag",
                            "column" : "vers_stamm.date_start"
                        },
                        {
                            "name" : "letzter_tag",
                            "label" : "Letzter Tag",
                            "column" : "vers_stamm.date_end"
                        }
                    ],
                    "table" : "vers_stamm",
                    "filter" : {
                        "type" : "SELECT",
                        "name" : "geschlecht",
                        "label" : "Geschlecht",
                        "column" : "vers_stamm.geschlecht",
                        "labels" : {
                            "1" : "Weiblich",
                            "2" : "Männlich"
                        },
                        "matchLabels" : false
                    }
                }
            ],
            "selects" : [
                {
                    "type" : "FIRST",
                    "column" : "vers_stamm.geschlecht",
                    "name" : "geschlecht_select",
                    "label" : "Geschlecht_select",
                    "description" : "Automatisch erzeugter Zusatzwert.",
                    "default" : true
                }
            ]
        },
		{
            "type" : "VIRTUAL",
            "name" : "versichertentage",
            "label" : "Versichertentage",
            "hidden" : false,
            "connectors" : [
                {
                    "name" : "versichertentage",
                    "label" : "Versichertentage",
                    "validityDates" : [
                        {
                            "name" : "datum",
                            "label" : "Datum",
                            "column" : "vers_tage_range.date"
                        }
                    ],
                    "selects" : [
                        {
                            "type" : "DURATION_SUM",
                            "column" : "vers_tage_range.date",
                            "name" : "versichertentage_select",
                            "label" : "Versichertentage_select",
                            "description" : "Automatisch erzeugter Zusatzwert.",
                            "default" : true
                        }
                    ],
                    "table" : "vers_tage_range",
                    "filter" : {
                        "type" : "DURATION_SUM",
                        "name" : "versichertentage",
                        "label" : "Versichertentage",
                        "unit" : "Tage",
                        "description" : "Versichertentage",
                        "column" : "vers_tage_range.date"
                    }
                }
            ]
        },
        {
            "type" : "VIRTUAL",
            "name" : "bundesland",
            "label" : "Bundesland",
            "hidden" : false,
            "connectors" : [
                {
                    "name" : "bundesland",
                    "label" : "Bundesland",
                    "validityDates" : [
                        {
                            "name" : "erster_tag",
                            "label" : "Erster Tag",
                            "column" : "vers_region.erster_tag"
                        },
                        {
                            "name" : "letzter_tag",
                            "label" : "Letzter Tag",
                            "column" : "vers_region.letzter_tag"
                        }
                    ],
                    "table" : "vers_region",
                    "filter" : {
                        "type" : "SELECT",
                        "name" : "bundesland",
                        "label" : "Bundesland",
                        "column" : "vers_region.bundesland",
                        "labels" : {
                            "01" : "Schleswig-Holstein",
                            "02" : "Hamburg",
                            "03" : "Niedersachsen",
                            "04" : "Bremen",
                            "05" : "Nordrhein-Westfalen",
                            "06" : "Hessen",
                            "07" : "Rheinland-Pfalz",
                            "08" : "Baden-Württemberg",
                            "09" : "Bayern",
                            "10" : "Saarland",
                            "11" : "Berlin",
                            "12" : "Brandenburg",
                            "13" : "Mecklenburg-Vorpommern",
                            "14" : "Sachsen",
                            "15" : "Sachsen-Anhalt",
                            "16" : "Thüringen"
                        },
                        "matchLabels" : false
                    }
                }
            ],
            "selects" : [
                {
                    "type" : "FIRST",
                    "column" : "vers_region.bundesland",
                    "name" : "bundesland_select",
                    "label" : "Bundesland_select",
                    "description" : "Automatisch erzeugter Zusatzwert.",
                    "default" : true
                }
            ]
        }        
    ],
    "content": {
        "tables": [
            {
                "csv": "tests/form/MAP_FORM/ver_stamm.csv",
                "name" : "vers_stamm",
                "primaryColumn" : {
                    "name" : "pid",
                    "type" : "STRING"
                },
                "columns" : [
                    {
                        "name" : "date",
                        "type" : "DATE_RANGE"
                    },
                    {
                        "name" : "dayType",
                        "type" : "STRING"
                    },
                    {
                        "name" : "date_start",
                        "type" : "DATE"
                    },
                    {
                        "name" : "date_end",
                        "type" : "DATE"
                    },
                    {
                        "name" : "bezugsjahr",
                        "type" : "INTEGER"
                    },
                    {
                        "name" : "geburtsdatum",
                        "type" : "DATE"
                    },
                    {
                        "name" : "export_geburtsdatum",
                        "type" : "STRING"
                    },
                    {
                        "name" : "geschlecht",
                        "type" : "STRING"
                    },
                    {
                        "name" : "sterbedatum",
                        "type" : "DATE"
                    },
                    {
                        "name" : "quell_ref",
                        "type" : "INTEGER"
                    },
                    {
                        "name" : "fehler_code",
                        "type" : "INTEGER"
                    },
                    {
                        "name" : "flag_analyse",
                        "type" : "INTEGER"
                    },
                    {
                        "name" : "flag_destatis",
                        "type" : "INTEGER"
                    },
                    {
                        "name" : "flag_demo",
                        "type" : "INTEGER"
                    },
                    {
                        "name" : "pid_hash",
                        "type" : "STRING"
                    }
                ]
            },
			{
				"csv": "tests/form/MAP_FORM/versicherten_tage.csv",
				"name" : "vers_tage_range",
                "primaryColumn" : {
                    "name" : "pid",
                    "type" : "STRING"
                },
                "columns" : [
                    {
                        "name" : "date",
                        "type" : "DATE_RANGE"
                    }
                ]
			},
			{
				"csv": "tests/form/MAP_FORM/vers_region.csv",
				"name" : "vers_region",
                "primaryColumn" : {
                    "name" : "pid",
                    "type" : "STRING"
                },
                "columns" : [
                    {
                        "name" : "bundesland",
                        "type" : "STRING"
                    },
                    {
                        "name" : "ausland",
                        "type" : "STRING"
                    },
                    {
                        "name" : "plz",
                        "type" : "STRING"
                    },
                    {
                        "name" : "kgs",
                        "type" : "STRING"
                    },
                    {
                        "name" : "kv_wohnort",
                        "type" : "STRING"
                    },
                    {
                        "name" : "erster_tag",
                        "type" : "DATE"
                    },
                    {
                        "name" : "letzter_tag",
                        "type" : "DATE"
                    }
                ]
			}
        ],
        "previousQueryResults": [
            "tests/form/MAP_FORM/query_results_1.csv"
        ]
    }
}